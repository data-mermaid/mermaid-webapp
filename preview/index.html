<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Mermaid Preview</title>
  </head>
  <body>
    <script>
      const prNumber = localStorage.getItem('authORedirectUrl')
      const redirectURL = `${window.location.origin}${prNumber}/index.html${window.location.search}`
      // eslint-disable-next-line no-console
      console.log('redirecting to', redirectURL, prNumber)

      if (prNumber) {
        window.location.replace(redirectURL)
      } else {
        // eslint-disable-next-line no-console
        console.log('no PR number found')
        let container = document.createElement('div')
        container.innerHTML = `
        <h1>You are not authenticated</h1>
        <p>Add the pull request number to the url path (ex. preview.app2.datamermaid.org/123/index.html) to sign in.</p>
        <p>If there are no open pull requests, no previews of this application are available.</p>  
      `
        document.body.appendChild(container)
      }
    </script>
  </body>
</html>
